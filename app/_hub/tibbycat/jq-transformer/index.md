---
name: jq-transformer
publisher: tibbycat
categories:
  - transformations
type: plugin
desc: Extends Kong with a wrapper for the amazing ./jq JSON processor
description: |
  Trivially transforms your request or response body with the https://stedolan.github.io/jq/ processor if the JSON payloads are slightly mis-aligned, without modifying code in your end service.
  * Transform the request & response to simplify the interface to your end service (eg Confluent's kafka REST proxy)
  * Remove sensitive(/private) information from your response payload.
  * Reduce your response payload size.
  NB: Content-Type header will probably affect your results. (application/.*json is probably the safest)

#support_url:
  # (Optional) A specific URL of your own for this extension.
  # Defaults to the url setting in your publisher profile.

source_url:
  https://github.com/tibbycat/kong-jq-transformer

license_type:
  https://opensource.org/licenses/alphabetical

#license_url:
  # (Optional) Link to your custom license.

#privacy_policy:
  # (Optional) If you have a custom privacy policy, place it here

#privacy_policy_url:
  # (Optional) Link to a remote privacy policy

#terms_of_service:
  # (Optional) Text describing your terms of service.

#terms_of_service_url:
  # (Optional) Link to your online TOS.

# COMPATIBILITY
# In the following sections, list Kong versions as array items.
# Versions are categorized by Kong edition and their known compatibility.
# Unlisted Kong versions will be considered incompatible.
# Uncomment at least one of 'community_edition' or 'enterprise_edition'.
# Add array-formatted lists of versions under their appropriate subsection.

kong_version_compatibility:
  community_edition:
    compatible:
      - 0.12.x
      - 0.14.x
#    incompatible:
  enterprise_edition:
    compatible:
      - 1.3.x
      - 1.5.x
      - 2.1.x
#    incompatible:


# EXAMPLE kong_version_compatibility block: this example shows how to indicate
# various compatibilities. Also see other extension files in _app/_hub/ for more examples.
#kong_version_compatibility:
#  community_edition:
#    compatible:
#      - 0.12.x
#      - 0.13.x
#      - 0.14.x
#  enterprise_edition:
#    compatible:
#      - 0.32-x
#      - 0.33-x
#      - 0.34-x

#########################
# PLUGIN-ONLY SETTINGS below this line
# If your plugin is an extension of the core platform, ALL of the following
# lines must be completed.
# If NOT defined as a 'plugin' in line 32, delete all lines up to '# BEGIN MARKDOWN CONTENT'

params: # Metadata about your plugin
  name: jq-transformer
  service_id:
    # Boolean - whether this plugin can be applied to a Service.
    # Affects generation of examples and config table.
  consumer_id:
    # Boolean - whether this plugin can be applied to a Consumer.
    # Affects generation of examples and config table.
  route_id:
    # whether this plugin can be applied to a Route.
    # Affects generation of examples and config table.
  protocols:
    # List of protocols this plugin is compatible with, in array format.
    # Valid values: "http", "https", "tcp", "tls"
    ["http", "https"]
  dbless_compatible:
    # Degree of compatibility with DB-less mode. Three values allowed:
    # 'yes', 'no' or 'partially'.
  dbless_explanation:
    # Optional free-text explanation, usually containing details about the degree of
    # compatibility with DB-less.
  yaml_examples:
    # Boolean - enables or disables autogenerated examples in declarative YAML
    # format. Default is `true`; set to `false` to disable only declarative
    # YAML examples.
  k8s_examples:
    # Boolean - enables or disables autogenerated examples in Kubernetes YAML
    # format. Default is `true`; set to `false` to disable only K8s examples.
  examples:
    # Boolean - enables or disables all autogenerated examples (cURL, YAML, and
    # Kubernetes). Default is `true`; set to `false` to disable all
    # autogenerated examples.

  config: # Configuration settings for your plugin
    - name: Request
      required: no
      default: empty string
      value_in_examples:
        # If the field is to appear in examples, this is the value to use.
        # A required field with no value_in_examples entry will resort to
        # the one in default.
        # If providing an array, use the following format: [ "value1", "value2" ].
      description:
        ./jq expression to transform request body by
    - name: Response
      required: no
      default: empty string
      value_in_examples:
        # If the field is to appear in examples, this is the value to use.
        # A required field with no value_in_examples entry will resort to
        # the one in default.
        # If providing an array, use the following format: [ "value1", "value2" ].
      description:
        ./jq expression to transform response body by
  #  - name: # add additional setting blocks as needed, each demarcated by -
  extra:
    # This is for additional remarks about your configuration.
###############################################################################
# END YAML DATA
# Beneath the next --- use Markdown (redcarpet flavor) and HTML formatting only.
#
# The remainder of this file is for free-form description, instruction, and
# reference matter.
# If you include headers, your headers MUST start at Level 2 (parsing to
# h2 tag in HTML). Heading Level 2 is represented by ## notation
# preceding the header text. Subsequent headings,
# if you choose to use them, must be properly nested (eg. heading level 2 may
# be followed by another heading level 2, or by heading level 3, but must NOT be
# followed by heading level 4)
###############################################################################
# BEGIN MARKDOWN CONTENT
---

More information & installation instructions on https://github.com/tibbycat/kong-jq-transformer
