{%- assign hub_example = include.hub_example -%}
{%- assign kong_manager_fields = hub_example.kong_manager.fields -%}

{% if page.metadata.global == false %}
  {:.important}
  > This plugin cannot be enabled globally. Please select another tab.
{% else %}
A plugin which is not associated to any service, route, or consumer is
considered _global_, and will be run on every request. Read the
[Plugin Reference](/gateway/latest/admin-api/#add-plugin) and the [Plugin Precedence](/gateway/latest/admin-api/#precedence)
sections for more information.

The following examples provide some typical configurations for enabling
the <code>{{page.metadata.name}}</code> plugin globally.
  {% navtabs %}
    {% navtab Admin API %}

Make the following request:

{% include_cached plugins/hub-examples/curl.html example=hub_example.curl %}

    {% endnavtab %}

    {% unless page.metadata.k8s_examples == false %}
      {% navtab Kubernetes %}

Create a [KongClusterPlugin](/kubernetes-ingress-controller/latest/references/custom-resources/#kongclusterplugin)
resource and label it as global:

```yaml
apiVersion: configuration.konghq.com/v1
kind: KongClusterPlugin
metadata:
  name: <global-{{ hub_example.plugin_name }}>
  annotations:
    kubernetes.io/ingress.class: kong
  labels:
    global: \"true\"
config:
  {%- for line in hub_example.kubernetes.example_config %}
  {{ line }}{%- endfor %}
plugin: {{ hub_example.plugin_name }}
```

      {% endnavtab %}
    {% endunless %}

    {% unless page.metadata.yaml_examples == false %}
      {% navtab Declarative (YAML) %}

Add a <code>plugins</code> entry in the declarative
configuration file:

{% include_cached plugins/hub-examples/yaml.html example=hub_example.yaml %}

      {% endnavtab %}
    {% endunless %}

    {% unless page.metadata.manager_examples == false or page.publisher != "Kong Inc." %}
      {% navtab Kong Manager %}


You can configure this plugin through the Kong Manager UI.

1. In Kong Manager, select the workspace.
2. Open **Plugins** from the menu, then click **New Plugin**.
3. Find and select the **{{ page.name }}** plugin.{%
    if page.enterprise == true or page.plus == true %}
    <blockquote class="note">
    <strong>Note:</strong> If the plugin is greyed out, then it is not available
    for your product tier. See <a href="/gateway/latest/licenses/">{{site.base_gateway}} tiers</a>.
    </blockquote>{% endif %}
4. If the option is available, set the plugin scope to **Global**.
{% unless kong_manager_fields.size == 0 -%}
5. Configure the plugin's [parameters](#parameters).

    You can test out the plugin with the following sample configuration:
    {% for field in kong_manager_fields %}
    * {{ field }}
    {% endfor -%}
{%- endunless %}
6. Click **Create**.

      {% endnavtab %}
    {% endunless %}
  {% endnavtabs %}
{% endif %}
